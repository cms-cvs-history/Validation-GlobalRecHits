process GLOBAL =
{

   untracked PSet maxEvents = {untracked int32 input = 1}

   ## setup useful services
   ##
   include "Validation/GlobalRecHits/data/Random.cfi"
   include "Validation/GlobalRecHits/data/MessageLogger.cfi"
   //service = Timing { }  
   //service = SimpleMemoryCheck { untracked int32 ignoreTotal = 1 }      

   ## Step 1: Read in MC+Sim events
   ## 
   ## read in OscarProducer file
   include "Validation/GlobalRecHits/data/PoolSource.cfi"
   replace maxEvents.input = -1

   ## Step 2 :  Accumulation of globally transformed data
   ##
   ## Setup Geometry (do I need this?)
   ##
   ## can't use official yet as it is configuration.xml rather than 
   ## SimConfiguration (how to change?)
   //include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"
   include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
   include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi"
   es_module = TrackerGeometricDetESModule {}
		
   ## Setup Magnetic Field (do I need this?)
   ##
   include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

   ## Accumulation of globally transformed data
   ##
   ##module globalrechits
   include "Validation/GlobalRecHits/data/globalrechits.cfi"
   replace globalrechits.Verbosity = 0
   replace globalrechits.Frequency = 50	

   ## Step 4 : Output module
   ##
   module o1 = PoolOutputModule 
   { 
      untracked string fileName = "GlobalRecHits.root"
      untracked vstring outputCommands = 
      {
        "keep *_globalrechhits_*_*"
      }
   }

   ## strip MC out of file
   //module o2 = PoolOutputModule 
   //{  
   //   untracked string fileName = "MC.root"
   //   untracked vstring outputCommands = 
   //   {
   //     "keep edmHepMCProduct_*_*_*"
   //   }
   //}

   ## execute path
   ##
   path p1 = { globalrechits }
   endpath outpath = { o1 }
   //endpath outpath = { o1, o2 }

}
